<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>OSINT Search Tool</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h1 { color: #333; }
    .section { margin-bottom: 30px; }
    .category, .site { padding: 5px; }
    .site-input, .category-input { margin: 5px 0; }
    .site-list { margin-top: 10px; }
    button { margin-left: 5px; }
    input[type="text"] { padding: 5px; width: 300px; }
    .hidden { display: none; }
    .checkbox-list { margin-left: 20px; }
  </style>
</head>
<body>
  <h1>OSINT Search Tool</h1>

  <div class="section">
    <label><strong>Enter Keyword:</strong></label><br/>
    <input type="text" id="keywordInput" placeholder="e.g. John Smith" />
    <button onclick="runSearch()">Search</button>
  </div>

  <div class="section">
    <h2>Categories & Sites</h2>
    <div id="categoryContainer"></div>
    <button onclick="showAddCategory()">+ Add Category</button>
    <div id="addCategoryForm" class="hidden">
      <input type="text" id="newCategoryName" placeholder="Category name" />
      <button onclick="addCategory()">Save</button>
    </div>
  </div>

  <div class="section">
    <h2>Add Website</h2>
    <input type="text" id="siteName" placeholder="Website name" class="site-input" />
    <input type="text" id="siteURL" placeholder="Website URL (https://...)" class="site-input" />
    <label>Select Categories:</label><br/>
    <div id="categoryCheckboxes" class="checkbox-list"></div>
    <button onclick="addWebsite()">Add Website</button>
  </div>

  <div class="section">
    <h2>Search Results</h2>
    <div id="results"></div>
  </div>

<script>
let categories = JSON.parse(localStorage.getItem('osintCategories')) || {
  "Company Searches": ["https://find-and-update.company-information.service.gov.uk/"],
  "Court Case Searches": ["https://www.casemine.com/"],
  "Occupation Registers": ["https://www.gdc-uk.org/pages/searchregisters.aspx"],
  "Genealogy": ["https://probatesearch.service.gov.uk/#wills"],
  "Transport": ["https://cartaxcheck.co.uk/"],
  "Sanctions, Watchlists, PEPs": ["https://www.insolvencydirect.bis.gov.uk/eiir/search"],
  "Social Media": ["https://www.facebook.com/"],
  "Offshore Companies": ["https://offshoreleaks.icij.org/"],
  "Domain/Leaked/Cached": ["https://who.is/"]
};

function saveCategories() {
  localStorage.setItem('osintCategories', JSON.stringify(categories));
}

function renderCategories() {
  const container = document.getElementById('categoryContainer');
  const checkboxArea = document.getElementById('categoryCheckboxes');
  container.innerHTML = '';
  checkboxArea.innerHTML = '';
  Object.entries(categories).forEach(([cat, urls]) => {
    const catDiv = document.createElement('div');
    catDiv.className = 'category';
    catDiv.innerHTML = `
      <strong>${cat}</strong>
      <button onclick="deleteCategory('${cat}')">Delete</button>
      <ul>
        ${urls.map(url => `<li>${url} <button onclick="deleteSite('${cat}', '${url}')">x</button></li>`).join('')}
      </ul>
    `;
    container.appendChild(catDiv);

    const checkbox = document.createElement('div');
    checkbox.innerHTML = `
      <input type="checkbox" id="cat_${cat}" value="${cat}" />
      <label for="cat_${cat}">${cat}</label>
    `;
    checkboxArea.appendChild(checkbox);
  });
}

function showAddCategory() {
  document.getElementById('addCategoryForm').classList.remove('hidden');
}

function addCategory() {
  const name = document.getElementById('newCategoryName').value.trim();
  if (name && !categories[name]) {
    categories[name] = [];
    saveCategories();
    renderCategories();
    document.getElementById('newCategoryName').value = '';
    document.getElementById('addCategoryForm').classList.add('hidden');
  }
}

function deleteCategory(cat) {
  if (confirm('Delete category and all associated websites?')) {
    delete categories[cat];
    saveCategories();
    renderCategories();
  }
}

function deleteSite(cat, url) {
  categories[cat] = categories[cat].filter(u => u !== url);
  saveCategories();
  renderCategories();
}

function addWebsite() {
  const name = document.getElementById('siteName').value.trim();
  const url = document.getElementById('siteURL').value.trim();
  const checkboxes = document.querySelectorAll('#categoryCheckboxes input:checked');
  if (!url || checkboxes.length === 0) return alert('Enter URL and select category');

  checkboxes.forEach(cb => {
    if (categories[cb.value] && !categories[cb.value].includes(url)) {
      categories[cb.value].push(url);
    }
  });
  saveCategories();
  renderCategories();
  document.getElementById('siteName').value = '';
  document.getElementById('siteURL').value = '';
  document.querySelectorAll('#categoryCheckboxes input').forEach(i => i.checked = false);
}

function runSearch() {
  const keyword = document.getElementById('keywordInput').value.trim();
  const checked = [...document.querySelectorAll('#categoryCheckboxes input:checked')].map(i => i.value);
  let results = '';
  checked.forEach(cat => {
    categories[cat].forEach(site => {
      const encoded = encodeURIComponent(keyword);
      results += `<div><a href="${site}" target="_blank">${site}</a> [${cat}]</div>`;
    });
  });
  document.getElementById('results').innerHTML = results || '<em>No results â€“ enter keyword and select categories.</em>';
}

// Initial render
renderCategories();
</script>

</body>
</html>
