<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Advanced OSINT Search Tool</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #fff;
      color: #222;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 24px;
    }
    section {
      background: #f0e6e1;
      border-radius: 12px;
      padding: 24px 24px 18px 24px;
      margin-bottom: 32px;
    }
    h1, h2, h3 {
      color: #B13F17;
      margin-bottom: 12px;
      font-weight: 700;
    }
    h1 { font-size: 2.4rem; margin-top: 0; }
    h2 { font-size: 1.5rem; }
    h3 { font-size: 1.1rem; }
    .btn, button, input[type="submit"] {
      background: #B13F17;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 10px 22px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
      margin: 0 4px 0 0;
      outline: none;
      box-shadow: none;
    }
    .btn:hover, button:hover, input[type="submit"]:hover { background: #8a2e11; }
    .btn-small { padding: 6px 14px; font-size: 0.95rem; border-radius: 4px; }
    .btn-danger { background: #dc3545; color: #fff; }
    .btn-danger:hover { background: #c82333; }
    .btn-success { background: #28a745; color: #fff; }
    .btn-success:hover { background: #218838; }
    .btn-secondary { background: #6c757d; color: #fff; }
    .btn-secondary:hover { background: #545b62; }
    input, select, textarea {
      padding: 10px 12px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
      margin-bottom: 8px;
      background: #fff;
      color: #222;
      outline: none;
      box-shadow: none;
      transition: border 0.2s;
    }
    input:focus, select:focus, textarea:focus { border: 1.5px solid #B13F17; }
    .search-container {
      display: flex;
      gap: 12px;
      margin-bottom: 18px;
    }
    .search-container input { flex: 1; }
    .advanced-options {
      background: #fff;
      border-radius: 8px;
      padding: 16px;
      margin-top: 16px;
      border: 1px solid #ddd;
    }
    .categories-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 18px;
      margin-bottom: 18px;
    }
    .category-card {
      background: #fff;
      border: 1px solid #eee;
      border-radius: 8px;
      padding: 16px 18px;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.2s;
    }
    .category-card:hover { box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .category-checkbox {
      width: 18px;
      height: 18px;
      accent-color: #B13F17;
    }
    .category-title {
      font-size: 1.08rem;
      font-weight: 600;
      color: #B13F17;
      flex-grow: 1;
      cursor: pointer;
    }
    .website-count {
      background: #f0e6e1;
      color: #B13F17;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 0.85rem;
      font-weight: 600;
    }
    .expand-btn {
      background: none;
      border: none;
      color: #B13F17;
      cursor: pointer;
      font-size: 1.2rem;
      padding: 2px 6px;
      border-radius: 3px;
      transition: background 0.2s;
    }
    .expand-btn:hover { background: #f0e6e1; }
    .category-websites {
      display: none;
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid #eee;
    }
    .category-websites.expanded { display: block; }
    .website-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px 0;
      font-size: 0.9rem;
    }
    .website-url {
      flex-grow: 1;
      color: #666;
      text-decoration: none;
    }
    .website-url:hover {
      color: #B13F17;
      text-decoration: underline;
    }
    .results-container { margin-top: 20px; }
    .result-item {
      background: #fff;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 15px;
      border: 1px solid #e9ecef;
      transition: all 0.2s;
    }
    .result-item:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    .result-match {
      border-left: 5px solid #28a745;
      background: linear-gradient(135deg, #f8fff8 0%, #ffffff 100%);
    }
    .result-no-match {
      border-left: 5px solid #dc3545;
      background: linear-gradient(135deg, #fff8f8 0%, #ffffff 100%);
      opacity: 0.8;
    }
    .result-error {
      border-left: 5px solid #ffc107;
      background: linear-gradient(135deg, #fffdf0 0%, #ffffff 100%);
    }
    .summary-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }
    .stat-card {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      border: 2px solid #e9ecef;
    }
    .stat-number {
      font-size: 2rem;
      font-weight: 700;
      color: #B13F17;
      margin-bottom: 5px;
    }
    .stat-label { color: #666; font-weight: 600; }
    .image-search-section {
      background: #f9f9f9;
      border-radius: 10px;
      padding: 18px 18px 10px 18px;
      margin: 24px 0 0 0;
      border: 1px solid #e0e0e0;
    }
    .image-drop-zone {
      border: 2px dashed #B13F17;
      border-radius: 8px;
      padding: 24px;
      text-align: center;
      color: #B13F17;
      background: #fff;
      margin-bottom: 16px;
      transition: background 0.2s;
    }
    .image-drop-zone.dragover { background: #f0e6e1; }
    .image-preview {
      max-width: 180px;
      max-height: 180px;
      margin: 10px auto 10px auto;
      display: block;
      border-radius: 8px;
      border: 1px solid #eee;
    }
    .image-search-links {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 10px;
      justify-content: center;
    }
    .image-search-links a {
      text-decoration: none;
      color: #fff;
      background: #B13F17;
      padding: 8px 16px;
      border-radius: 6px;
      font-weight: 600;
      transition: background 0.2s;
      font-size: 1rem;
    }
    .image-search-links a:hover { background: #8a2e11; }
    @media (max-width: 768px) {
      .container { padding: 15px; }
      .categories-grid { grid-template-columns: 1fr; }
      .summary-stats { grid-template-columns: repeat(2, 1fr); }
      .image-search-links { flex-direction: column; align-items: stretch; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header style="text-align:center; margin-bottom:40px;">
      <h1>üïµÔ∏è Advanced OSINT Search Tool</h1>
      <p style="color:#666; font-size:1.2rem;">Professional Open Source Intelligence Investigation Platform</p>
    </header>

    <!-- Search Section -->
    <section>
      <h2>üîç Primary Search</h2>
      <div class="search-container">
        <input type="text" id="searchInput" placeholder="Enter person name, company, email, phone, etc...">
        <button id="searchBtn" class="btn">üöÄ Start Investigation</button>
      </div>
      <div class="advanced-options">
        <h3>üéØ Search Options</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
          <label>
            <input type="checkbox" id="deepSearch" checked> Deep Content Analysis
          </label>
          <label>
            <input type="checkbox" id="followRedirects" checked> Follow Redirects
          </label>
          <label>
            <input type="checkbox" id="extractEmails"> Extract Email Addresses
          </label>
          <label>
            <input type="checkbox" id="extractPhones"> Extract Phone Numbers
          </label>
          <label>
            <input type="number" id="maxResults" placeholder="Max results per site" min="1" max="50" value="10" style="width: 100px;"> Max Results
          </label>
          <label>
            <select id="searchMode">
              <option value="comprehensive">Comprehensive Search</option>
              <option value="quick">Quick Search</option>
              <option value="targeted">Targeted Search</option>
            </select>
          </label>
        </div>
      </div>
    </section>

    <!-- Image Search Section -->
    <section class="image-search-section">
      <h2>üñºÔ∏è Image Search (Reverse Lookup)</h2>
      <div id="imageDropZone" class="image-drop-zone">
        Drag & Drop an image here or <label style="color:#B13F17;cursor:pointer;text-decoration:underline;"><input type="file" id="imageInput" accept="image/*" style="display:none;">browse</label>
      </div>
      <img id="imagePreview" class="image-preview" style="display:none;" alt="Preview">
      <div id="imageSearchLinks" class="image-search-links" style="display:none;"></div>
      <div style="color:#666; font-size:0.98rem; text-align:center; margin-top:10px;">
        Supported: Google Images, TinEye, Yandex, Bing Images, Baidu Images
      </div>
    </section>

    <!-- Categories Section -->
    <section>
      <h2>üìã Investigation Categories</h2>
      <div class="categories-grid" id="categoriesContainer"></div>
      <div style="margin-top: 20px;">
        <button class="btn btn-small" id="selectAllBtn">‚úÖ Select All</button>
        <button class="btn btn-small" id="deselectAllBtn">‚ùå Deselect All</button>
        <button class="btn btn-small" id="selectRecommendedBtn">üéØ Recommended Only</button>
      </div>
    </section>

    <!-- Results Section -->
    <section>
      <h2>üìä Investigation Results</h2>
      <div style="margin-bottom:12px;">
        <input type="text" id="caseRefInput" placeholder="Case Reference Number" style="width:220px;">
        <button class="btn btn-small btn-success" id="loadCaseBtn">üîÑ Load Case</button>
        <button class="btn btn-small btn-secondary" id="exportBtn">‚¨áÔ∏è Export Selected</button>
      </div>
      <div id="searchSummary" style="display: none;">
        <div class="summary-stats">
          <div class="stat-card">
            <div class="stat-number" id="totalSearched">0</div>
            <div class="stat-label">Sites Searched</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="totalMatches">0</div>
            <div class="stat-label">Matches Found</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="avgScore">0</div>
            <div class="stat-label">Avg. Relevance</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="successRate">0%</div>
            <div class="stat-label">Success Rate</div>
          </div>
        </div>
      </div>
      <div id="resultsContainer" class="results-container">
        <div style="text-align: center; color: #666; padding: 60px 20px;">
          <div style="font-size: 3rem; margin-bottom: 20px;">üîç</div>
          <h3>Ready to Start Investigation</h3>
          <p>Enter your search terms and select categories to begin comprehensive OSINT analysis</p>
        </div>
      </div>
    </section>
  </div>

  <script>
    // --- CATEGORY & SITE DATABASE ---
    const defaultSiteDatabase = {
      "Searches": [
        { name: "Companies House UK", baseUrl: "https://find-and-update.company-information.service.gov.uk/" },
        { name: "Haulage Index", baseUrl: "https://haulage-index.co.uk/index.php" },
        { name: "Insolvency Direct", baseUrl: "https://www.insolvencydirect.bis.gov.uk/eiir/search" },
        { name: "Caseboard", baseUrl: "https://caseboard.io/cases/" }
      ],
      "Court Case Searches": [
        { name: "CaseMine", baseUrl: "https://www.casemine.com/" },
        { name: "ECHR HUDOC", baseUrl: "https://hudoc.echr.coe.int/eng#{%22documentcollectionid2%22:[%22GRANDCHAMBER%22,%22CHAMBER%22]}" },
        { name: "BAILII", baseUrl: "https://www.bailii.org/" },
        { name: "Employment Tribunal Decisions", baseUrl: "https://www.gov.uk/employment-tribunal-decisions" },
        { name: "Supreme Court UK", baseUrl: "https://www.supremecourt.uk/cases" }
      ],
      "Occupation Registers": [
        { name: "GDC Search Registers", baseUrl: "https://www.gdc-uk.org/pages/searchregisters.aspx" },
        { name: "GMC Medical Register", baseUrl: "https://www.gmc-uk.org/registration-and-licensing/the-medical-register" },
        { name: "GDC Registration", baseUrl: "https://www.gdc-uk.org/registration" },
        { name: "NMC Register", baseUrl: "https://www.nmc.org.uk/registration/search-the-register" },
        { name: "HCPC Register", baseUrl: "https://www.hcpc-uk.org/check-the-register" },
        { name: "Pharmacy Register", baseUrl: "https://www.pharmacyregulation.org/registers" },
        { name: "Optical Register", baseUrl: "https://www.optical.org/en" },
        { name: "GCC Register", baseUrl: "https://www.gcc-uk.org/registration/the-register" },
        { name: "Osteopathy Register", baseUrl: "https://www.osteopathy.org.uk/register-search" },
        { name: "SRA Solicitor Check", baseUrl: "https://www.sra.org.uk/consumers/solicitor-check/" },
        { name: "Bar Standards Board", baseUrl: "https://www.barstandardsboard.org.uk/for-the-public/finding-a-barrister.html" },
        { name: "CLC Find a Conveyancer", baseUrl: "https://www.clc-uk.org/consumers/find-a-licensed-conveyancer/" },
        { name: "CILEX Directory", baseUrl: "https://www.cilexregulation.org.uk/practitioners-directory" },
        { name: "Faculty Office Notary", baseUrl: "https://www.facultyoffice.org.uk/notary/find-a-notary/" },
        { name: "ICAEW Find", baseUrl: "https://find.icaew.com/" },
        { name: "ACCA Find an Accountant", baseUrl: "https://www.accaglobal.com/an/en/member/find-an-accountant.html" },
        { name: "RICS Find a Member", baseUrl: "https://www.rics.org/find-a-member" },
        { name: "ARB", baseUrl: "https://arb.org.uk/public-information/members-of-the-public/" },
        { name: "Engineering Council Registers", baseUrl: "https://www.engc.org.uk/registers" },
        { name: "Electrical Competent Person", baseUrl: "https://www.electricalcompetentperson.co.uk/" },
        { name: "Gas Safe Register", baseUrl: "https://www.gassaferegister.co.uk/find-an-engineer" },
        { name: "NHBC Find a Builder", baseUrl: "https://www.nhbc.co.uk/homeowners/find-a-builder" },
        { name: "FMB Find a Builder", baseUrl: "https://www.fmb.org.uk/find-a-builder" },
        { name: "IPI Find an Investigator", baseUrl: "https://ipi.org.uk/find-an-investigator" },
        { name: "SIA Register", baseUrl: "https://services.sia.homeoffice.gov.uk/rolh/" },
        { name: "OISC Adviser Finder", baseUrl: "https://home.oisc.gov.uk/adviser_finder/finder.aspx" },
        { name: "Social Work England", baseUrl: "https://www.socialworkengland.org.uk/search-the-register/" },
        { name: "BPS Psychological Workforce", baseUrl: "https://www.bps.org.uk/psychological-workforce" },
        { name: "RCVS Find a Vet", baseUrl: "https://findavet.rcvs.org.uk/home/" },
        { name: "CQC Find a Care Home", baseUrl: "https://www.cqc.org.uk/find-a-care-home" },
        { name: "FCA Register", baseUrl: "https://register.fca.org.uk/" },
        { name: "Charity Commission Register", baseUrl: "https://register-of-charities.charitycommission.gov.uk/" }
      ],
      "Genealogy": [
        { name: "UK Probate Search", baseUrl: "https://probatesearch.service.gov.uk/#wills" }
      ],
      "Transport": [
        { name: "Car Tax Check", baseUrl: "https://cartaxcheck.co.uk/" },
        { name: "Plane Finder", baseUrl: "https://planefinder.net/" },
        { name: "Marine Traffic", baseUrl: "https://www.marinetraffic.com/en/ais/home/centerx:-12.0/centery:25.0/zoom:4" },
        { name: "Vessel Finder", baseUrl: "https://www.vesselfinder.com/vessels" },
        { name: "Haulage Index", baseUrl: "https://haulage-index.co.uk/index.php" },
        { name: "Racing Post Racecards", baseUrl: "https://www.racingpost.com/racecards" }
      ],
      "Sanctions, Watchlists, Insolvency, PEPs": [
        { name: "Insolvency Direct", baseUrl: "https://www.insolvencydirect.bis.gov.uk/eiir/search" },
        { name: "The Gazette", baseUrl: "https://www.thegazette.co.uk/all-notices/notice?service=all-notices" },
        { name: "Interpol Red Notices", baseUrl: "https://www.interpol.int/en/How-we-work/Notices/Red-Notices/View-Red-Notices" },
        { name: "Interpol Yellow Notices", baseUrl: "https://www.interpol.int/en/How-we-work/Notices/Yellow-Notices/View-Yellow-Notices" },
        { name: "FBI Most Wanted", baseUrl: "https://www.fbi.gov/wanted/topten" },
        { name: "Proscribed Terror Groups", baseUrl: "https://www.gov.uk/government/publications/proscribed-terror-groups-or-organisations--2/proscribed-terrorist-groups-or-organisations-accessible-version" },
        { name: "EU Most Wanted", baseUrl: "https://eumostwanted.eu/" },
        { name: "UK Sanctions List", baseUrl: "https://search-uk-sanctions-list.service.gov.uk/" },
        { name: "NCA Most Wanted", baseUrl: "https://www.nationalcrimeagency.gov.uk/most-wanted" },
        { name: "FCA Warning List", baseUrl: "https://www.fca.org.uk/consumers/warning-list-unauthorised-firms" },
        { name: "SFO Cases", baseUrl: "https://www.gov.uk/sfo-cases" },
        { name: "Vexatious Litigants", baseUrl: "https://www.gov.uk/guidance/vexatious-litigants" },
        { name: "Tax Defaulters", baseUrl: "https://www.gov.uk/government/publications/publishing-details-of-deliberate-tax-defaulters-pddd/current-list-of-deliberate-tax-defaulters" }
      ],
      "Social Media": [
        { name: "Facebook", baseUrl: "https://www.facebook.com/" },
        { name: "LinkedIn", baseUrl: "https://www.linkedin.com" },
        { name: "Instagram", baseUrl: "https://www.instagram.com/" },
        { name: "X (Twitter)", baseUrl: "https://x.com" },
        { name: "TikTok", baseUrl: "https://www.tiktok.com/?kuid=31b6d78a-c086-437f-9ab0-df56eaf7fd8b&kref=vGWRdzLJnjYf" },
        { name: "Reddit", baseUrl: "https://www.reddit.com/" }
      ],
      "Offshore Companies": [
        { name: "Offshore Leaks", baseUrl: "https://offshoreleaks.icij.org/" },
        { name: "OpenCorporates", baseUrl: "https://opencorporates.com/" }
      ],
      "Domain/Leaked/Cached": [
        { name: "Who.is", baseUrl: "https://who.is/" },
        { name: "Wayback Machine", baseUrl: "https://web.archive.org/" },
        { name: "AnalyzeID", baseUrl: "https://analyzeid.com/" },
        { name: "Have I Been Pwned", baseUrl: "https://haveibeenpwned.com/" },
        { name: "IP Fingerprints", baseUrl: "https://www.ipfingerprints.com/" },
        { name: "DataBreach", baseUrl: "https://databreach.com/" }
      ]
    };

    let categories = defaultSiteDatabase;
    let selectedCategories = new Set();

    // --- CATEGORY RENDERING ---
    function renderCategories() {
      const container = document.getElementById('categoriesContainer');
      container.innerHTML = '';
      Object.entries(categories).forEach(([categoryName, sites]) => {
        const categoryCard = document.createElement('div');
        categoryCard.className = 'category-card';
        categoryCard.innerHTML = `
          <input type="checkbox" class="category-checkbox" id="cat-${categoryName}" data-category="${categoryName}">
          <div class="category-title" onclick="toggleCategory('${categoryName}')">${categoryName}</div>
          <div class="website-count">${sites.length}</div>
          <button class="expand-btn" onclick="expandCategory('${categoryName}')">‚ñº</button>
          <div class="category-websites" id="websites-${categoryName}">
            ${sites.map(site => `
              <div class="website-item">
                <a href="${site.baseUrl}" target="_blank" class="website-url">${site.name}</a>
              </div>
            `).join('')}
          </div>
        `;
        container.appendChild(categoryCard);
      });
    }

    function toggleCategory(categoryName) {
      const checkbox = document.getElementById(`cat-${categoryName}`);
      checkbox.checked = !checkbox.checked;
      updateSelectedCategories();
    }

    function expandCategory(categoryName) {
      const websites = document.getElementById(`websites-${categoryName}`);
      const btn = websites.previousElementSibling;
      if (websites.classList.contains('expanded')) {
        websites.classList.remove('expanded');
        btn.textContent = '‚ñº';
      } else {
        websites.classList.add('expanded');
        btn.textContent = '‚ñ≤';
      }
    }

    function updateSelectedCategories() {
      selectedCategories.clear();
      document.querySelectorAll('.category-checkbox:checked').forEach(cb => {
        selectedCategories.add(cb.dataset.category);
      });
    }

    function setupEventListeners() {
      document.getElementById('searchBtn').addEventListener('click', startSearch);
      document.getElementById('searchInput').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') startSearch();
      });
      document.getElementById('selectAllBtn').addEventListener('click', () => {
        document.querySelectorAll('.category-checkbox').forEach(cb => cb.checked = true);
        updateSelectedCategories();
      });
      document.getElementById('deselectAllBtn').addEventListener('click', () => {
        document.querySelectorAll('.category-checkbox').forEach(cb => cb.checked = false);
        updateSelectedCategories();
      });
      document.getElementById('selectRecommendedBtn').addEventListener('click', () => {
        document.querySelectorAll('.category-checkbox').forEach(cb => {
          const recommended = ['Searches', 'Occupation Registers', 'Court Case Searches'];
          cb.checked = recommended.includes(cb.dataset.category);
        });
        updateSelectedCategories();
      });
      document.addEventListener('change', (e) => {
        if (e.target.classList.contains('category-checkbox')) {
          updateSelectedCategories();
        }
      });
    }

    // --- IMAGE SEARCH ---
    function setupImageSearch() {
      const dropZone = document.getElementById('imageDropZone');
      const imageInput = document.getElementById('imageInput');
      const imagePreview = document.getElementById('imagePreview');
      const imageLinks = document.getElementById('imageSearchLinks');

      function showLinks(imgUrl) {
        imageLinks.innerHTML = `
          <a href="https://images.google.com/searchbyimage?image_url=${encodeURIComponent(imgUrl)}" target="_blank">Google Images</a>
          <a href="https://tineye.com/search?url=${encodeURIComponent(imgUrl)}" target="_blank">TinEye</a>
          <a href="https://yandex.com/images/search?rpt=imageview&url=${encodeURIComponent(imgUrl)}" target="_blank">Yandex</a>
          <a href="https://www.bing.com/images/searchbyimage?cbir=sbi&imgurl=${encodeURIComponent(imgUrl)}" target="_blank">Bing Images</a>
          <a href="https://image.baidu.com/n/pc_search?queryImageUrl=${encodeURIComponent(imgUrl)}" target="_blank">Baidu Images</a>
        `;
        imageLinks.style.display = '';
      }

      function handleImage(file) {
        if (!file.type.startsWith('image/')) return;
        const reader = new FileReader();
        reader.onload = function(e) {
          imagePreview.src = e.target.result;
          imagePreview.style.display = 'block';
          showLinks(e.target.result);
        };
        reader.readAsDataURL(file);
      }

      dropZone.addEventListener('dragover', e => {
        e.preventDefault();
        dropZone.classList.add('dragover');
      });
      dropZone.addEventListener('dragleave', e => {
        e.preventDefault();
        dropZone.classList.remove('dragover');
      });
      dropZone.addEventListener('drop', e => {
        e.preventDefault();
        dropZone.classList.remove('dragover');
        if (e.dataTransfer.files.length) handleImage(e.dataTransfer.files[0]);
      });
      dropZone.addEventListener('click', () => imageInput.click());
      imageInput.addEventListener('change', e => {
        if (e.target.files.length) handleImage(e.target.files[0]);
      });
    }

    // --- SEARCH LOGIC (UI DEMO) ---
    function startSearch() {
      const query = document.getElementById('searchInput').value.trim();
      if (!query) {
        alert('Please enter a search term');
        return;
      }
      if (selectedCategories.size === 0) {
        alert('Please select at least one category to search');
        return;
      }
      showSearchProgress();
      simulateSearch(query);
    }

    function showSearchProgress() {
      const resultsContainer = document.getElementById('resultsContainer');
      resultsContainer.innerHTML = `
        <div style="text-align: center; padding: 40px;">
          <div style="font-size: 2rem; margin-bottom: 20px;">üîÑ</div>
          <h3>Investigation in Progress...</h3>
          <p>Searching across selected databases and platforms</p>
          <div style="background: #e9ecef; height: 20px; border-radius: 10px; overflow: hidden; margin: 20px 0;">
            <div id="progress-bar" style="background: #B13F17; height: 100%; width: 0%; transition: width 0.5s;"></div>
          </div>
          <div id="progress-text">Initializing search...</div>
        </div>
      `;
    }

    function simulateSearch(query) {
      let progress = 0;
      const progressBar = document.getElementById('progress-bar');
      const progressText = document.getElementById('progress-text');
      const interval = setInterval(() => {
        progress += Math.random() * 15;
        if (progress > 100) progress = 100;
        progressBar.style.width = progress + '%';
        progressText.textContent = `Searching ${Math.floor(progress)}% complete...`;
        if (progress >= 100) {
          clearInterval(interval);
          setTimeout(() => showMockResults(query), 1000);
        }
      }, 500);
    }

    // --- ADVANCED SCRAPING/EXTRACTION (UI DEMO) ---
    let savedResults = {};
    let currentCaseRef = "";

    function getRelevanceScore(query, site) {
      let score = 0;
      if (site.name.toLowerCase().includes(query.toLowerCase())) score += 5;
      if (site.baseUrl.toLowerCase().includes(query.toLowerCase())) score += 3;
      score += Math.floor(Math.random() * 3);
      return score;
    }

    function showMockResults(query) {
      const resultsContainer = document.getElementById('resultsContainer');
      const searchSummary = document.getElementById('searchSummary');
      searchSummary.style.display = 'block';
      document.getElementById('totalSearched').textContent = selectedCategories.size * 3;
      document.getElementById('totalMatches').textContent = Math.floor(Math.random() * 8) + 2;
      document.getElementById('avgScore').textContent = (Math.random() * 3 + 7).toFixed(1);
      document.getElementById('successRate').textContent = Math.floor(Math.random() * 30 + 60) + '%';
      const mockResults = generateMockResults(query);
      resultsContainer.innerHTML = mockResults;
      setupResultSaving();
    }

    function generateMockResults(query) {
      const results = [];
      let allResults = [];
      selectedCategories.forEach(categoryName => {
        const sites = categories[categoryName];
        sites.forEach(site => {
          const score = getRelevanceScore(query, site);
          const hasMatch = score > 4;
          allResults.push({
            category: categoryName,
            site,
            hasMatch,
            score,
            snippet: generateMockSnippet(query, site.name)
          });
        });
      });
      allResults.sort((a, b) => b.score - a.score);
      allResults.slice(0, 10).forEach((result, idx) => {
        results.push(`
          <div class="result-item ${result.hasMatch ? 'result-match' : 'result-no-match'}">
            <label style="float:right;">
              <input type="checkbox" class="result-checkbox" data-idx="${idx}">
              Save
            </label>
            <div style="font-size: 1.2rem; font-weight: 700; color: #B13F17;">
              ${result.site.name}
            </div>
            <div style="color: #666; font-size: 0.9rem;">${result.category}</div>
            <div style="margin:8px 0;">
              <b>Relevance:</b> ${result.score}/10
              <br>
              <b>Snippet:</b> ${result.snippet}
            </div>
            <a href="${result.site.baseUrl}" target="_blank" class="btn btn-small btn-secondary">üîó Go to Source</a>
          </div>
        `);
      });
      window._lastResults = allResults.slice(0, 10);
      return results.join('');
    }

    function generateMockSnippet(query, siteName) {
      const snippets = [
        `Profile information matching search criteria`,
        `Record found in ${siteName.toLowerCase()} database`,
        `Professional registration details available`,
        `Historical records and associated data`,
        `Contact information and business associations`
      ];
      return snippets[Math.floor(Math.random() * snippets.length)];
    }

    function setupResultSaving() {
      document.getElementById('resultsContainer').addEventListener('change', function(e) {
        if (e.target.classList.contains('result-checkbox')) {
          saveCheckedResults();
        }
      });
      document.getElementById('exportBtn').onclick = exportResults;
      document.getElementById('loadCaseBtn').onclick = loadCase;
      document.getElementById('caseRefInput').onchange = function() {
        currentCaseRef = this.value.trim();
      };
    }

    function saveCheckedResults() {
      const caseRef = document.getElementById('caseRefInput').value.trim();
      if (!caseRef) return;
      const checked = Array.from(document.querySelectorAll('.result-checkbox'))
        .map((cb, idx) => cb.checked ? window._lastResults[idx] : null)
        .filter(Boolean);
      if (!savedResults[caseRef]) savedResults[caseRef] = [];
      savedResults[caseRef] = checked;
      localStorage.setItem('osint_cases', JSON.stringify(savedResults));
    }

    function exportResults() {
      const caseRef = document.getElementById('caseRefInput').value.trim();
      if (!caseRef || !savedResults[caseRef] || !savedResults[caseRef].length) {
        alert('No saved results for this case.');
        return;
      }
      const data = savedResults[caseRef];
      const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `osint_case_${caseRef}.json`;
      a.click();
      URL.revokeObjectURL(url);
    }

    function loadCase() {
      const caseRef = document.getElementById('caseRefInput').value.trim();
      if (!caseRef) return;
      const stored = localStorage.getItem('osint_cases');
      if (stored) savedResults = JSON.parse(stored);
      if (savedResults[caseRef]) {
        const resultsContainer = document.getElementById('resultsContainer');
        resultsContainer.innerHTML = savedResults[caseRef].map((result, idx) => `
          <div class="result-item result-match">
            <label style="float:right;">
              <input type="checkbox" class="result-checkbox" data-idx="${idx}" checked>
              Saved
            </label>
            <div style="font-size: 1.2rem; font-weight: 700; color: #B13F17;">
              ${result.site.name}
            </div>
            <div style="color: #666; font-size: 0.9rem;">${result.category}</div>
            <div style="margin:8px 0;">
              <b>Relevance:</b> ${result.score}/10
              <br>
              <b>Snippet:</b> ${result.snippet}
            </div>
            <a href="${result.site.baseUrl}" target="_blank" class="btn btn-small btn-secondary">üîó Go to Source</a>
          </div>
        `).join('');
      } else {
        alert('No saved results for this case.');
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      const stored = localStorage.getItem('osint_cases');
      if (stored) savedResults = JSON.parse(stored);
      renderCategories();
      setupEventListeners();
      setupImageSearch();
    });
  </script>
</body>
</html>
